# Login

mutation login($user: String!, $password: String!) {
    login(user: $user, password: $password)
}

# Info

query whoAmI {
    whoAmI { user, roles }
}

query distributionInfo {
    distributionInfo { distribution, title }
}

# Developer Versions

query developerVersionsInProcess ($service: String) {
    developerVersionsInProcess (service: $service) {
        service, version { build }, author, sources { name, git { url, branch, cloneSubmodules } }, comment, taskId, startTime
    }
}

query developerVersionsInfo ($service: String, $version: DeveloperVersionInput) {
    developerVersionsInfo (service: $service, version: $version) {
        service, version { distribution, build }, buildInfo { author, sources { name, git { url, branch, cloneSubmodules } }, date, comment }
    }
}

query developerDesiredVersions {
    developerDesiredVersions { service, version { distribution, build } }
}

query providerDesiredVersions ($distribution: String!) {
    providerDesiredVersions (distribution: $distribution) { service, version { distribution, build } }
}

mutation buildDeveloperVersion ($service: String!, $version: DeveloperVersionInput!, $sources: [SourceConfigInput!]!, $comment: String!) {
    buildDeveloperVersion (service: $service, version: $version, sources: $sources, comment: $comment)
}

mutation addDeveloperVersionInfo ($info: DeveloperVersionInfoInput!) {
    addDeveloperVersionInfo (info: $info)
}

mutation removeDeveloperVersion ($service: String!, $version: DeveloperDistributionVersionInput!) {
    removeDeveloperVersion (service: $service, version: $version)
}

mutation setDeveloperDesiredVersions ($versions: [DeveloperDesiredVersionDeltaInput!]!) {
    setDeveloperDesiredVersions (versions: $versions)
}

# Client Versions

query clientVersionsInfo ($service: String!, $version: ClientVersionInput) {
    clientVersionsInfo (service: $service, version: $version) {
        service, version { distribution, developerBuild, clientBuild }, buildInfo { author, sources { name, git { url, branch, cloneSubmodules } }, date, comment }, installInfo { user, date }
    }
}

query clientDesiredVersions {
    clientDesiredVersions { service, version { distribution, developerBuild, clientBuild } }
}

query installedDesiredVersions ($distribution: String!) {
    installedDesiredVersions (distribution: $distribution) {
        service, version { distribution, developerBuild, clientBuild }
    }
}

mutation buildClientVersion ($service: String!, $developerVersion: DeveloperDistributionVersionInput!, $clientVersion: ClientDistributionVersionInput!) {
    buildClientVersion (service: $service, developerVersion: $developerVersion, clientVersion: $clientVersion)
}

mutation addClientVersionInfo ($info: ClientVersionInfoInput!) {
    addClientVersionInfo (info: $info)
}

mutation removeClientVersion ($service: String!, $version: ClientDistributionVersionInput!) {
    removeClientVersion (service: $service, version: $version)
}

mutation setClientDesiredVersions ($versions: [ClientDesiredVersionDeltaInput!]!) {
    setClientDesiredVersions (versions: $versions)
}

# States

query serviceStates ($distribution: String!) {
    serviceStates (distribution: $distribution) {
        distribution, instance { instance, service, directory, state { date, installDate, startDate, version { distribution, developerBuild, clientBuild }, updateToVersion { distribution, developerBuild, clientBuild }, updateError { critical, error }, failuresCount, lastExitCode } }
    }
}

# Services

query usersInfo ($human: Boolean!) {
    usersInfo (human: $human) { user, human, name, roles, email, notifications }
}

query usersList {
    usersInfo { user }
}

query userInfo ($user: String!) {
    usersInfo (user: $user) { user, human, name, roles, email, notifications }
}

mutation addUser ($user: String!, $human: Boolean!, $name: String!, $password: String!, $roles: [UserRole!]!, $email: String, $notifications: [String!]) {
    addUser (user: $user, human: $human, name: $name, password: $password, roles: $roles, email: $email, notifications: $notifications)
}

mutation changeUser ($user: String!, $name: String, $oldPassword: String, $password: String, $roles: [UserRole!], $email: String, $notifications: [String!]) {
    changeUser (user: $user, name: $name, oldPassword: $oldPassword, password: $password, roles: $roles, email: $email, notifications: $notifications)
}

mutation removeUser ($user: String!) {
    removeUser (user: $user)
}

# Sources

query developerServices {
    developerServices
}

query serviceSources ($service: String!) {
    serviceSources (service: $service) { name, git { url, branch, cloneSubmodules }  }
}

mutation addServiceSources ($service: String!, $sources: [SourceConfigInput!]!) {
    addServiceSources (service: $service, sources: $sources)
}

mutation changeServiceSources ($service: String!, $sources: [SourceConfigInput!]!) {
    changeServiceSources (service: $service, sources: $sources)
}

mutation removeServiceSources ($service: String!) {
    removeServiceSources (service: $service)
}

# Profiles

query serviceProfiles {
    serviceProfiles { profile }
}

query profileServices ($profile: String!) {
    serviceProfiles (profile: $profile) { services }
}

mutation addServicesProfile ($profile: String!, $services: [String!]!) {
    addServicesProfile (profile: $profile, services: $services)
}

mutation changeServicesProfile ($profile: String!, $services: [String!]!) {
    changeServicesProfile (profile: $profile, services: $services)
}

mutation removeServicesProfile ($profile: String!) {
    removeServicesProfile (profile: $profile)
}

# Providers

query providersInfo {
    providersInfo {
        distribution, url, uploadStateIntervalSec
    }
}

mutation addProvider ($distribution: String!, $url: URL!, $uploadStateIntervalSec: Int!) {
    addProvider (distribution: $distribution, url: $url, uploadStateIntervalSec: $uploadStateIntervalSec)
}

mutation changeProvider ($distribution: String!, $url: URL!, $uploadStateIntervalSec: Int!) {
    changeProvider (distribution: $distribution, url: $url, uploadStateIntervalSec: $uploadStateIntervalSec)
}

mutation removeProvider ($distribution: String!) {
    removeProvider (distribution: $distribution)
}

# Consumers

query consumersInfo {
    consumersInfo {
        distribution, profile, testConsumer
    }
}

mutation addConsumer ($distribution: String!, $profile: String!, $testConsumer: String) {
    addConsumer (distribution: $distribution, profile: $profile, testConsumer: $testConsumer)
}

mutation changeConsumer ($distribution: String!, $profile: String!, $testConsumer: String) {
    changeConsumer (distribution: $distribution, profile: $profile, testConsumer: $testConsumer)
}

mutation removeConsumer ($distribution: String!) {
    removeConsumer (distribution: $distribution)
}

# Subscriptions

subscription subscribeTaskLogs ($task: String!, $from: Long) {
    subscribeTaskLogs (task: $task, from: $from) {
        sequence, line { date, level, unit, message, terminationStatus }
    }
}

subscription subscribeServiceLogs ($distribution: String!, $service: String!, $instance: String!, $process: String!,
        $directory: String!, $from: Long!) {
    subscribeServiceLogs (distribution: $distribution, service: $service, instance: $instance, process: $process,
            directory: $directory, from: $from) {
        sequence, line { date, level, unit, message, terminationStatus }
    }
}